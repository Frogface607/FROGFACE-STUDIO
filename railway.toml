[build]
builder = "NIXPACKS"
buildCommand = "pnpm install --prod=false && echo '=== BUILDING FROM ROOT WITH WORKSPACE RESOLUTION ===' && pnpm --filter '@frogface/core-api-client' build && echo '✅ 1/6 api-client built' && pnpm --filter '@frogface/core-agent-base' build && echo '✅ 2/6 agent-base built' && pnpm --filter '@frogface/core-knowledge-base' build && echo '✅ 3/6 knowledge-base built' && pnpm --filter '@frogface/agent-copywriter' build && echo '✅ 4/6 copywriter built' && pnpm --filter '@frogface/agent-archivist' build && echo '✅ 5/6 archivist built' && pnpm --filter '@frogface/agent-edison-copywriter' build && echo '✅ 6/6 edison-copywriter built' && pnpm --filter '@frogface/core-mcp' build && echo '=== CHECKING mcp-server build ===' && ls -la packages/core/mcp-server/dist/ && echo '=== Looking for server.js ===' && if test -f packages/core/mcp-server/dist/server.js; then echo '✅✅✅ server.js EXISTS! ✅✅✅'; else echo '❌ server.js NOT FOUND!'; echo 'Files in dist:'; find packages/core/mcp-server/dist -type f; exit 1; fi && echo '✅✅✅ READY TO DEPLOY! ✅✅✅'"

[deploy]
startCommand = "cd /app && node packages/core/mcp-server/dist/server.js"
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10
